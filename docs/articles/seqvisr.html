<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>seqvisr • seqvisr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="seqvisr">
<meta property="og:description" content="seqvisr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqvisr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/seqvisr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vragh/seqvisr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="seqvisr_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>seqvisr</h1>
                        <h4 class="author">Venket Raghavan</h4>
            
            <h4 class="date">7/31/2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vragh/seqvisr/blob/master/vignettes/seqvisr.Rmd"><code>vignettes/seqvisr.Rmd</code></a></small>
      <div class="hidden name"><code>seqvisr.Rmd</code></div>

    </div>

    
    
<div id="what-is-seqvisr" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-seqvisr" class="anchor"></a>What is <code>seqvisr</code>?</h2>
<p>Visualizing biological sequence data is a common use-case in bioinformatics, computational biology, and biology as a whole. “Visualization” is often in the form of a cartoon/diagram that captures the relevant higher-level information while abstracting away the sequence itself. For instance: a protein sequence is (in some senses) much more comprehensible like so:</p>
<p><code>------[DOMAIN1]------[DOMAIN2]------</code></p>
<p>Than like so:</p>
<p><code>MEVPTMSFGECAPSDRGDRFHWMPFDSTGGCVLPDD</code></p>
<p><code>seqvisr</code> is an attempt to bring such functionality to <code>R</code> whereby sequences can be visualized in <code>R</code> natively without having to resort to external tools.</p>
<p>In specific, <code>seqvisr</code> offers two functions (at the moment):</p>
<ul>
<li><p><code><a href="../reference/msavisr.html">msavisr()</a></code> for visualizing multiple sequence alignments (MSAs).</p></li>
<li><p><code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> for visualizing amino acid/protein sequences.</p></li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>As of version <code>0.2.0</code>, <code>seqvisr</code> is only available via <code>GitHub</code> (<a href="https://github.com/vragh/seqvisr" class="uri">https://github.com/vragh/seqvisr</a>). Please ensure that the <code>devtools</code> package has been installed already (<code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("devtools")</a></code>). <code>seqvisr</code> can be installed as follows:</p>
<p><code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("vragh/seqvisr")</a></code></p>
<p>Then load the package for use like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/vragh/seqvisr">"seqvisr"</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="multiple-sequence-alignment-msa-visualization-with-msavisr" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-sequence-alignment-msa-visualization-with-msavisr" class="anchor"></a>Multiple sequence alignment (MSA) visualization with <code>msavisr()</code>
</h2>
<p>A sequence alignment is a relative arrangement of two sequences such that identical/similar character in either sequence are aligned to each other. An MSA is an extension of this concept to more than two sequences (see <a href="https://en.wikipedia.org/wiki/Multiple_sequence_alignment" class="uri">https://en.wikipedia.org/wiki/Multiple_sequence_alignment</a> for an introduction). MSAs are informative with regards to evolutionary, structural, and functional conservation of DNA and proteins. A typical MSA might look something like this:</p>
<p><code>Seq1 ATGCATTT</code></p>
<p><code>Seq2 ATGC-TTT</code></p>
<p><code>Seq3 AT-C-TTT</code></p>
<p><code>Seq4 ATGC-T--</code></p>
<p>Although MSAs can be inspected and interpreted by hand, this can be an extremely cumbersome process. This is especially true for MSAs that have thousands of columns and tens or hundreds of sequences.</p>
<p><code><a href="../reference/msavisr.html">msavisr()</a></code> was developed to alleviate this problem.</p>
<p>Given the path to a <code>FASTA</code>-formatted file containing an MSA, the user can use <code><a href="../reference/msavisr.html">msavisr()</a></code> to designate one of the sequences within as the “reference”, and then visualize all the other sequences in terms of gaps/insertions/deletions with respect to it. In addition, arbitrary features of interest (“regions of interest”/<code>ROI</code>s)–e.g., a single residue on the 5th sequence in the alignment–can be specified to the function to highlight it separately, giving the user full control over the visualization process.</p>
<p>Here is an example illustrating the the basic function call.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Loading sample data.</span>
<span class="va">testmsa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"testaln_mrna.fasta"</span>, package <span class="op">=</span> <span class="st">"seqvisr"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">#Basic visualization with the sequence "Ref0" set as the reference.</span>
<span class="fu"><a href="../reference/msavisr.html">msavisr</a></span><span class="op">(</span>mymsa <span class="op">=</span> <span class="va">testmsa</span>, myref <span class="op">=</span> <span class="st">"Ref0"</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/msavisr_examples-1.png" width="576"></p>
<p>The basic features highlighted by <code><a href="../reference/msavisr.html">msavisr()</a></code> are the matches, mismatches, and gaps in the MSA. By default, <code><a href="../reference/msavisr.html">msavisr()</a></code> uses colorblind-friendly colors. Set <code>cbfcols = FALSE</code> to disable this.</p>
<p>The defining feature of <code><a href="../reference/msavisr.html">msavisr()</a></code> is that arbitrary portions of one or more sequences can be highlighted by specifying them as <code>regions of interest</code> (<code>ROI</code>s). These will show up with their own colors in addition to the matches, mismatches, and gaps.</p>
<p>Each <code>ROI</code> must be indicated as a vector wherein the first value indicates the sequence (optional), the second the position(s) as integer (ranges), and the third an identifier string for the ROI.</p>
<p>So an <code>ROI</code> looks like this:</p>
<p><code><a href="https://rdrr.io/r/base/c.html">c("sequence_name", positions_as_integers, "sequence_identifier")</a></code></p>
<p>As <code><a href="../reference/msavisr.html">msavisr()</a></code> can accept an arbitrary number of <code>ROI</code>s, these <code>ROI</code> vectors must always be passed to the function enclosed in a <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> like so:</p>
<p><code><a href="https://rdrr.io/r/base/list.html">list(c(...), c(...), ...)</a></code></p>
<p>Wherein in each <code><a href="https://rdrr.io/r/base/c.html">c(...)</a></code> is an <code>ROI</code> vector.</p>
<p>EVEN IF ONLY ONE <code>ROI</code> is being passed to <code><a href="../reference/msavisr.html">msavisr()</a></code>, it MUST be enclosed by the <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> function.</p>
<p>Here is an example of <code><a href="../reference/msavisr.html">msavisr()</a></code> with a single <code>ROI</code> named “Ref0 Domain1” that covers positions 100 to 110 on the sequence “Ref0”.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">roi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ref0"</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">110</span>, <span class="st">"Ref0 Domain1"</span><span class="op">)</span>

<span class="fu"><a href="../reference/msavisr.html">msavisr</a></span><span class="op">(</span>mymsa <span class="op">=</span> <span class="va">testmsa</span>, myref <span class="op">=</span> <span class="st">"Ref0"</span>, myroi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">roi1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/roi1-1.png" width="576"></p>
<p>An example with additional <code>ROI</code>s.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#A ROI that indicates a single column (number 14) in the MSA as pseudouridines (a type of a modified nucleic acid).</span>
<span class="va">roi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="st">"Pseudouridine"</span><span class="op">)</span>

<span class="co">#A "Domain2" defined on all sequences as existing between positions 20 and 30.</span>
<span class="va">roi3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">30</span>, <span class="st">"Domain2"</span><span class="op">)</span>

<span class="co">#A single nucleotide polymorphism (SNP) at position 55 on the sequence "Seq2".</span>
<span class="va">roi4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Seq2"</span>, <span class="fl">55</span>, <span class="st">"SNP"</span><span class="op">)</span>

<span class="co">#Putting all the ROIs in a list and passing it to msavisr().</span>
<span class="va">roi_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">roi1</span>, <span class="va">roi2</span>, <span class="va">roi3</span>, <span class="va">roi4</span><span class="op">)</span>

<span class="fu"><a href="../reference/msavisr.html">msavisr</a></span><span class="op">(</span>mymsa <span class="op">=</span> <span class="va">testmsa</span>, myref <span class="op">=</span> <span class="st">"Ref0"</span>, myroi <span class="op">=</span> <span class="va">roi_list</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/roi_list-1.png" width="576"></p>
<p>The dimensions of the matches (i.e., conserved positions), non-matches (i.e., mismatches and gaps), and <code>ROI</code>s can be adjusted freely. For example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">roi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ref0"</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">110</span>, <span class="st">"Ref0 Domain1"</span><span class="op">)</span>

<span class="fu"><a href="../reference/msavisr.html">msavisr</a></span><span class="op">(</span>mymsa <span class="op">=</span> <span class="va">testmsa</span>, myref <span class="op">=</span> <span class="st">"Ref0"</span>, myroi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">roi1</span><span class="op">)</span>, hroi <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/dim_ctrl-1.png" width="576"></p>
<p>The user can also set the colors for the matches, mismatches, and gaps manually through the <code>basecolors</code> argument. Likewise, custom colors for the <code>ROI</code>s can be set through the <code>roicolors</code> argument. In both cases colors should be supplied as alphanumeric vectors, and there must be as many colors as there are features. (But <code><a href="../reference/msavisr.html">msavisr()</a></code> will attempt to provide its own color replacements if any are missing.)</p>
<p>Supplying custom colors is especially useful in cases where <code><a href="../reference/msavisr.html">msavisr()</a></code> assigns colors that are too close to one another in colorspace. Also, since <code><a href="../reference/msavisr.html">msavisr()</a></code> chooses colors randomly, custom colors may be preferrable in situations where the colors should be maintained over multiple plots. (Note: <code><a href="../reference/msavisr.html">msavisr()</a></code> will ALWAYS attempt to assign unique colors to every feature including the basic features.)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">roi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ref0"</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">110</span>, <span class="st">"Ref0 Domain1"</span><span class="op">)</span>

<span class="fu"><a href="../reference/msavisr.html">msavisr</a></span><span class="op">(</span>mymsa <span class="op">=</span> <span class="va">testmsa</span>, myref <span class="op">=</span> <span class="st">"Ref0"</span>, myroi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">roi1</span><span class="op">)</span>, hroi <span class="op">=</span> <span class="fl">0.8</span>, roicolors <span class="op">=</span> <span class="op">(</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/color_demo-1.png" width="576"></p>
<p>Finally, the function is sequence alphabet agnostic. So it will work with both amino acid and nucleotide sequences. However, its capability to handle amino acid mismatches is only very basic at the moment. For instance, it cannot recognize conservative substitutions, and will color all mismatches with the same color.</p>
<p>Please see <code><a href="../reference/msavisr.html">?msavisr</a></code> for more information on this function.</p>
</div>
<div id="protein-domain-visualization-with-pdomvisr" class="section level2">
<h2 class="hasAnchor">
<a href="#protein-domain-visualization-with-pdomvisr" class="anchor"></a>Protein domain visualization with <code>pdomvisr()</code>
</h2>
<p>Sequences (especially protein sequences) are often subject to annotation whereby domains and other features of interest are identifed in them. It is often very useful to visualize sequence annotations, and <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> represents a native tool in <code>R</code> to achieve this.</p>
<p>Most tools provide the annotation data in a tabular format (alongside other formats). Irrespective of what the output table looks like, it can be coerced into this form:</p>
<p><code>sequence_name sequence_length sequence_offset domain_name domain_start domain_end</code></p>
<p><code>seq1             300               0        dom1          200        250</code></p>
<p><code>seq1             300               0        dom2          270        280</code></p>
<p><code>seq2             600               0        dom1          150        170</code></p>
<p><code>seq2             600               0        dom2          400        550</code></p>
<p>The columns here are self-explanatory. All columns here <strong>except</strong> <code>sequence_offset</code> should be generated by most annotation tools automatically. The <code>sequence_offset</code> column is something that needs to be manually added: it is specific to <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code>, and allows for appropriate placement of partial sequences (especially with reference to other sequences). This is useful, for instance, when only an internal fragment of a protein sequence is being plotted. <strong>For most use cases, the <code>sequence_offset</code> column values can be set to 0</strong>.</p>
<p><strong>Needless to say, each row corresponds to one particular domain in the sequence</strong>. Therefore, sequences with multiple domains should have multiple rows in the table.</p>
<p>This is the standard (and only accepted) input format for <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code>. <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> can be provided a name of (or path to) a file that contains the data formatted in this manner. Alternatively, if the data has already been loaded into the <code>R</code> environment, the function can simply be passed this <code>data.frame</code>/<code>data.table</code>/<code>tibble</code>’s name. In any case, given this input data, <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> will then draw domain structure.</p>
<p>Here is <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> in action.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Loading some sample data.</span>
<span class="va">inpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pdomvisr_testdata.tsv"</span>, package <span class="op">=</span> <span class="st">"seqvisr"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">annotdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">inpath</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">inpdat</span> <span class="op">&lt;-</span> <span class="va">annotdat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span>

<span class="fu"><a href="../reference/pdomvisr.html">pdomvisr</a></span><span class="op">(</span><span class="va">inpdat</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/pdomvisr-1.png" width="576"></p>
<p>For those interested, this is what <code>inpdat</code> looks like:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inpdat</span></code></pre></div>
<pre><code>##   prot_acc seq_len offset signature_desc start_loc stop_loc
## 1     Seq1     579      0           dom1       308      407
## 2     Seq1     579      0           dom2       133      184
## 3     Seq2     855      0           dom1       275      373
## 4     Seq2     855      0           dom2       118      216</code></pre>
<p>It is similar to the input table described above.</p>
<p><strong>Note:</strong> although the data were read into <code>R</code> using <code>read.table</code> in the example above, this is not strictly necessary for <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code>. The user can also simply supply it the path to the file, and it will work all the same as long as the data in the file formatted as described above.</p>
<p>One issue that is immediately apparent is that the labels on the domains are not easy to read. By default, <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> lets <code>ggplot2</code> calculate the label sizes automatically (<code>label_size = "auto"</code>). To amend this, the labels can either be switched off (by setting <code>label_size = 0</code>) or reduced in size.</p>
<p>Plot with labeling switched off:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pdomvisr.html">pdomvisr</a></span><span class="op">(</span><span class="va">inpdat</span>, label_size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/label_off-1.png" width="576"></p>
<p>Plot with labeling switched off:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pdomvisr.html">pdomvisr</a></span><span class="op">(</span><span class="va">inpdat</span>, label_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/label_small-1.png" width="576"></p>
<p>One potential issue with the tabular output of most annotation tools is that <em>sequences that have no annotations</em> assigned to them are <em>not</em> listed in the table. There can be scenarios where a sequence with no domains must be visualized alongside its counterparts that do.</p>
<p><code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> can handle this quite easily.</p>
<p>In such instances, the user simply needs to add (at least) one row for this featureless sequence. The sequence name, sequence length, and offset (if needed) must be specified correctly. The column corresponding to the domain name should carry a <code>NA</code> string, and the start and end positions should be set to 0. This is illustrated below.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inpdat</span> <span class="op">&lt;-</span> <span class="va">annotdat</span><span class="op">[</span><span class="fl">6</span>, <span class="op">]</span>
<span class="va">inpdat</span></code></pre></div>
<pre><code>##   prot_acc seq_len offset signature_desc start_loc stop_loc
## 6     Seq4    1197      0           &lt;NA&gt;         0        0</code></pre>
<p>And plotting this would result in this:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pdomvisr.html">pdomvisr</a></span><span class="op">(</span><span class="va">inpdat</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/featureless_seq_plotted-1.png" width="576"></p>
<p>There is no legend because there are no domains/features to be displayed.</p>
<p>If this were to be displayed alongside other sequences, it might look like this:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inpdat</span> <span class="op">&lt;-</span> <span class="va">annotdat</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span>
<span class="fu"><a href="../reference/pdomvisr.html">pdomvisr</a></span><span class="op">(</span><span class="va">inpdat</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/featureless_w_others-1.png" width="576"></p>
<p>An important feature of <code><a href="../reference/pdomvisr.html">pdomvisr()</a></code> is that it accepts an “offset” parameter that indicates how far away from the actual first position of the sequence the indicated sequence itself is. For instance, a sequence of length 300 might actually be a fragment of a longer sequence that is 500 residues long, with the 300 residue-long sequence being the latter half of it. In such an instance, the rows for this sequence should have an offset value of 200.</p>
<p>This is demonstrated with a small example below where the same sequence is plotted with and without an offset:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w_offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w_offset"</span>, <span class="fl">300</span>, <span class="fl">200</span>, <span class="st">"dom1"</span>, <span class="fl">210</span>, <span class="fl">240</span><span class="op">)</span>
<span class="va">no_offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no_offset"</span>, <span class="fl">300</span>, <span class="fl">0</span>, <span class="st">"dom1"</span>, <span class="fl">210</span>, <span class="fl">240</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">w_offset</span>, <span class="va">no_offset</span><span class="op">)</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="../reference/pdomvisr.html">pdomvisr</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/offset_example-1.png" width="576"></p>
<p>As can be seen, the only difference is that the sequence with the offset supplied starts further down along the X-axis. By default, the “sequence” corresponding to the offset length is shown. This can be disabled by setting <code>show_offsets = FALSE</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pdomvisr.html">pdomvisr</a></span><span class="op">(</span><span class="va">df</span>, show_offsets <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="seqvisr_files/figure-html/offset_disable-1.png" width="576"></p>
<p>The heights, transparencies, and fill colors for the non-feature portions of the sequences can be adjusted by the user. In addition, the number of breaks on the X-axis, legend visibility, and <strong>usage of colorblind-friendly colors</strong> can also be set by the user. Refer to the help page (<code><a href="../reference/pdomvisr.html">?pdomvisr</a></code>) for more details on these.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Venket Raghavan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
