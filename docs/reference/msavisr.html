<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multiple sequence alignment (MSA) visualization and manipulation thereof. — msavisr • seqvisr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple sequence alignment (MSA) visualization and manipulation thereof. — msavisr"><meta property="og:description" content="Given a fasta formatted MSA, msavisr will attempt to produce a visualization of the MSA
with matches, mismatches, gaps, and (optional) regions of interest (ROIs) being highlighted
in different colors. The matches, mismatches, and gaps are calculated by comparing all other
sequences to a designated reference sequence within the MSA. ROIs are specified manually (see
below)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqvisr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/seqvisr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/vragh/seqvisr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiple sequence alignment (MSA) visualization and manipulation thereof.</h1>
    <small class="dont-index">Source: <a href="https://github.com/vragh/seqvisr/blob/HEAD/R/msavisr.R" class="external-link"><code>R/msavisr.R</code></a></small>
    <div class="hidden name"><code>msavisr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a fasta formatted MSA, msavisr will attempt to produce a visualization of the MSA
with matches, mismatches, gaps, and (optional) regions of interest (ROIs) being highlighted
in different colors. The matches, mismatches, and gaps are calculated by comparing all other
sequences to a designated reference sequence within the MSA. ROIs are specified manually (see
below).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">msavisr</span><span class="op">(</span>mymsa <span class="op">=</span> <span class="cn">NULL</span>, myref <span class="op">=</span> <span class="cn">NULL</span>, mypath <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>refontop <span class="op">=</span> <span class="cn">TRUE</span>, myroi <span class="op">=</span> <span class="cn">NULL</span>, hnon <span class="op">=</span> <span class="cn">NULL</span>, hmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>hroi <span class="op">=</span> <span class="cn">NULL</span>, wnon <span class="op">=</span> <span class="cn">NULL</span>, wmat <span class="op">=</span> <span class="cn">NULL</span>, wroi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>anon <span class="op">=</span> <span class="cn">NULL</span>, amat <span class="op">=</span> <span class="cn">NULL</span>, aroi <span class="op">=</span> <span class="cn">NULL</span>, basecolors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>roicolors <span class="op">=</span> <span class="cn">NULL</span>, cbfcols <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mymsa</dt>
<dd><p>(character string, mandatory) the name of the fasta-formatted file containing the
multiple sequence alignment (MSA). The full path to the file can also be provided here (in which
case, the mypath argument must be set to NULL).</p></dd>


<dt>myref</dt>
<dd><p>(character string, mandatory) the fasta header (not including the "&gt;") of one of the
sequences in the MSA which act as the reference sequence.</p></dd>


<dt>mypath</dt>
<dd><p>(character string, optional) the path to the directory containing the MSA. (Default
: looks in the current directory.)</p></dd>


<dt>refontop</dt>
<dd><p>(boolean, optional) should the reference sequence be placed at the top of the MSA plot
(default) or at the bottom? (Set to FALSE for bottom.)</p></dd>


<dt>myroi</dt>
<dd><p>(list of vectors, optional) the user can manually specify regions of interest (ROI;
i.e., positions in the MSA) that they wish to highlight manually via myroi. This must be supplied
as a list of vectors wherein each vector is of the format c(seqname, pos, desc), or c(seqname, pos),
or c(pos, desc), or c(pos). The seqname (name of a specific sequence in the MSA) and the desc
(description of the feature) are optional. pos (i.e., the positions that denote the ROI) can be a
single integer (e.g., 100), or a range of integers (1:10). Each such ROI vector can also hold one
or more (and combinations) of single integer pos values and integer range pos values (e.g., something
like c("Seq1", 1:10, 100, "Helix")). Thus, for example, if a SNP at position 100 in "seq2" and a the
region of nucleotides/amino-acids 20:30 representing a domain in all sequences were to be ROIs, they
would be supplied like so list(c("seq2", 100, "SNP"), c(20:30, "domain")). ROIs can be assigned any
color by the user (see argument roicolors); colors are assigned automatically otherwise (optionally
from a color blind-friendly palette; see argument cbfcols).</p></dd>


<dt>hnon</dt>
<dd><p>(double, optional) the height of the feature "bar(s)" for all mismatches and gaps in the MSA. (Default: 0.4.)</p></dd>


<dt>hmat</dt>
<dd><p>(double, optional) the height of the feature "bar(s)" for all matches in the MSA. (Default: 0.4.)</p></dd>


<dt>hroi</dt>
<dd><p>(double, optional) the height of the feature "bar(s)" for all ROIs in the MSA. (Default: 0.4.)</p></dd>


<dt>wnon</dt>
<dd><p>(double, optional) the width of the feature "bar(s)" for all mismatches and gaps in the MSA. (Default: 2.0.)</p></dd>


<dt>wmat</dt>
<dd><p>(double, optional) the width of the feature "bar(s)" for all matches in the MSA. (Default: 1.0.)</p></dd>


<dt>wroi</dt>
<dd><p>(double, optional) the width of the feature "bar(s)" for all ROIs in the MSA. (Default: 4.0.)</p></dd>


<dt>anon</dt>
<dd><p>(double, optional) the transparency of the feature "bar(s)" for all mismatches and gaps in the MSA. (Default: 1.0.)</p></dd>


<dt>amat</dt>
<dd><p>(double, optional) the transparency of the feature "bar(s)" for all matches in the MSA. (Default: 1.0.)</p></dd>


<dt>aroi</dt>
<dd><p>(double, optional) the transparency of the feature "bar(s)" for all ROIs in the MSA. (Default: 1.0.)</p></dd>


<dt>basecolors</dt>
<dd><p>(vector of 3 character strings, optional) the colors for the matches, mismatches, and gaps can optionally be
supplied by the user via this argument. Defaults are c("gray", "black", "white") when no colors are supplied and cbfcols (see
below) is set to FALSE. If cbfcols == TRUE, and no colors are supplied by the user then a palette from viridis is chosen.</p></dd>


<dt>roicolors</dt>
<dd><p>(vector of n character strings, optional) user-specified colors for the ROI features can be supplied via this
argument. As many colors as there are ROIs need to be supplied, and the order of the colors should correspond to the order of the
ROIs in the input list. If too few colors are supplied, colors are reused; if too many are supplied, the last few colors will not
be used. Defaults are chosen automacially from grDevices::color() if cbfcols == FALSE, and from viridis otherwise.</p></dd>


<dt>cbfcols</dt>
<dd><p>(boolean, optional) allows for the user to choose whether the automatic coloring scheme used should be color-blind
friendly. (Default: TRUE; set to FALSE to use non-color blind-friendly colors.)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A ggplot2 object is returned to the parent environment for plotting and/or further downstream processing/manipulation.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>msavisr plots the matches as a separate geom_tile() layer, the gaps + mismatches as a geom_tile() layer, and the ROIs as a
separate geom_tile() layer (if ROIs are supplied).</p>
<p>The user will have to tweak the values for the widths and heights of these layers (via the arguments outlined above) to achieve
the desired visualization "effects". In general, it is advisable to set the widths of the mismatches + gaps (and/or ROIs, if any;
so wnon and wroi respectively) larger than that of the matches (wmat). The heights can be increased if necessary. Altering the
transparency levels does not seem to be very useful. Note: altering the transparency levels does not update the transparency of
the colors shown in the legend!!</p>
<p>ROIs are especially useful for visualizing features such as single nucleotide polymorphisms (SNPs) in nucleotide MSAs and other
such isolated features that might normally become "buried" within the bulk of the sequence. This can be easily achieved by
indicating the SNPs position as an ROI and jacking up its width (wroi) and/or height (hroi) values.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The only issue with specifying ROIs in the manner implemented here is that, if for instance, a ROI in "seq2" at position 100
and in "seq4" at the same position need to be highlighted, it cannot be supplied like so c("seq2", "seq4", 100), and instead must
be supplied as two separate vectors c("seq2", 100), c("seq4", 100). The lowdown: specifying common ROIs in a SUBSET of the MSA can
be a tedious process. Unfortunately, as of now, no internal workarounds have been implemented.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#Input data</span></span></span>
<span class="r-in"><span><span class="va">testmsa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"testaln_mrna.fasta"</span>, package <span class="op">=</span> <span class="st">"seqvisr"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Basic visualization</span></span></span>
<span class="r-in"><span><span class="fu">msavisr</span><span class="op">(</span>mymsa <span class="op">=</span> <span class="va">testmsa</span>, myref <span class="op">=</span> <span class="st">"Ref0"</span><span class="op">)</span> <span class="co">#No ROIs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Defining an example ROI</span></span></span>
<span class="r-in"><span><span class="va">testroi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ref0"</span>, <span class="fl">100</span><span class="op">:</span><span class="fl">110</span>, <span class="st">"Ref0 Domain1"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="st">"Pseudouridine"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">30</span>, <span class="st">"Domain2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Seq2"</span>, <span class="fl">55</span>, <span class="st">"SNP"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#MSA with ROIs</span></span></span>
<span class="r-in"><span><span class="fu">msavisr</span><span class="op">(</span>mymsa <span class="op">=</span> <span class="va">testmsa</span>, myref <span class="op">=</span> <span class="st">"Ref0"</span>, myroi <span class="op">=</span> <span class="va">testroi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Venket Raghavan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

